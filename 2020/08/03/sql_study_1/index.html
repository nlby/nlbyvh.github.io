<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>sql_study_1 | Memory</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="对牛客网sql练习61道做一个简单总结">
<meta property="og:type" content="article">
<meta property="og:title" content="sql_study_1">
<meta property="og:url" content="http://yoursite.com/2020/08/03/sql_study_1/index.html">
<meta property="og:site_name" content="Memory">
<meta property="og:description" content="对牛客网sql练习61道做一个简单总结">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-08-03T08:09:57.000Z">
<meta property="article:modified_time" content="2020-08-03T09:01:56.296Z">
<meta property="article:author" content="nlby">
<meta property="article:tag" content="sql">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Memory" type="application/atom+xml">
  
  
    <link rel="icon" href="https://i.loli.net/2020/03/21/oSCA8lZVKMG6OBp.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
      <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script>AV.initialize("F3vqXSGcnb9cM3bvLFT2skRf-gzGzoHsz", "kTj2Ad4Ye9Q3U5uHGjFXHCcx");</script>

<script src="/js/Counter.js"></script>

  
<meta name="generator" content="Hexo 4.2.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://i.loli.net/2020/03/21/oSCA8lZVKMG6OBp.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">nlby</a></h1>
		</hgroup>

		
		<p class="header-subtitle">永远相信美好的事情即将发生</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						<li>
						<iframe frameborder="no" border="0" marginwidth="0"
						marginheight="0" width=200 height=86 src="//music.163.com/outchain/player?type=0&id=4872500795&auto=1&height=66">
						</iframe></li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Go/" style="font-size: 14.44px;">Go</a> <a href="/tags/JavaWeb/" style="font-size: 20px;">JavaWeb</a> <a href="/tags/Python-Science/" style="font-size: 15.56px;">Python Science</a> <a href="/tags/PythonWeb/" style="font-size: 13.33px;">PythonWeb</a> <a href="/tags/android/" style="font-size: 17.78px;">android</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 12.22px;">前端</a> <a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" style="font-size: 13.33px;">区块链</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E6%A1%86%E6%9E%B6/" style="font-size: 10px;">博客框架</a> <a href="/tags/%E5%A3%B0%E4%BC%98%E8%AE%B0%E5%BD%95/" style="font-size: 10px;">声优记录</a> <a href="/tags/%E5%B0%8F%E8%AF%B4%E6%95%B4%E7%90%86/" style="font-size: 11.11px;">小说整理</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 13.33px;">总结</a> <a href="/tags/%E6%95%88%E6%9E%9C/" style="font-size: 10px;">效果</a> <a href="/tags/%E7%95%AA%E5%89%A7%E8%AE%B0%E5%BD%95/" style="font-size: 18.89px;">番剧记录</a> <a href="/tags/%E9%80%9A%E7%94%A8/" style="font-size: 10px;">通用</a> <a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 16.67px;">随笔</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io/zh-cn/docs/">hexo</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://nlby.github.io/">another</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">nlby</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://i.loli.net/2020/03/21/oSCA8lZVKMG6OBp.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">nlby</h1>
			</hgroup>
			
			<p class="header-subtitle">永远相信美好的事情即将发生</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-sql_study_1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/08/03/sql_study_1/" class="article-date">
  	<time datetime="2020-08-03T08:09:57.000Z" itemprop="datePublished">2020-08-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      sql_study_1
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql/" rel="tag">sql</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/%E8%AE%B0%E5%BD%95/">记录</a>
	</div>


        
          
<div class="counter-tag counter">
    <span id="/2020/08/03/sql_study_1/" class="leancloud_visitors post-title-link"
          style="font-size: 12px" data-flag-title="sql_study_1">
         &nbsp;
        view
    </span>
</div>

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>对牛客网sql练习61道做一个简单总结 </p>
<a id="more"></a>
<p>牛客网 <a href="https://www.nowcoder.com/practice/218ae58dfdcd4af195fff264e062138f?tpId=82&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking" target="_blank" rel="noopener">https://www.nowcoder.com/practice/218ae58dfdcd4af195fff264e062138f?tpId=82&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking</a><br>相关视频 <a href="https://www.bilibili.com/video/BV175411s7yr?p=61" target="_blank" rel="noopener">https://www.bilibili.com/video/BV175411s7yr?p=61</a><br>61道题，大概分为两个部分，前35道基本全是查询，后26道是一些其他语句的用法，最难写的大概在22-35这十几道。</p>
<p> PDF To Markdown Converter<br>Debug View<br>Result View</p>
<h3 id="查找最晚入职员工的所有信息，为了减轻入门难度，目前所有的数据里员工入职的日期都"><a href="#查找最晚入职员工的所有信息，为了减轻入门难度，目前所有的数据里员工入职的日期都" class="headerlink" title="查找最晚入职员工的所有信息，为了减轻入门难度，目前所有的数据里员工入职的日期都"></a>查找最晚入职员工的所有信息，为了减轻入门难度，目前所有的数据里员工入职的日期都</h3><h3 id="不是同一天"><a href="#不是同一天" class="headerlink" title="不是同一天"></a>不是同一天</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE &#96;employees&#96; (</span><br><span class="line">&#96;emp_no&#96; int(11) NOT NULL comment &#39;员工编号&#39;,</span><br><span class="line">&#96;birth_date&#96; date NOT NULL,</span><br><span class="line">&#96;first_name&#96; varchar(14) NOT NULL,</span><br><span class="line">&#96;last_name&#96; varchar(16) NOT NULL,</span><br><span class="line">&#96;gender&#96; char(1) NOT NULL,</span><br><span class="line">&#96;hire_date&#96; date NOT NULL,</span><br><span class="line">PRIMARY KEY (&#96;emp_no&#96;));</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from employees</span><br><span class="line">where hire_date &#x3D; (select max(hire_date) from employees);</span><br></pre></td></tr></table></figure>
<h1 id="01-查找最晚入职员工的所有信息"><a href="#01-查找最晚入职员工的所有信息" class="headerlink" title="01. 查找最晚入职员工的所有信息"></a>01. 查找最晚入职员工的所有信息</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><h3 id="查找入职员工时间排名倒数第三的员工所有信息，为了减轻入门难度，目前所有的数据里"><a href="#查找入职员工时间排名倒数第三的员工所有信息，为了减轻入门难度，目前所有的数据里" class="headerlink" title="查找入职员工时间排名倒数第三的员工所有信息，为了减轻入门难度，目前所有的数据里"></a>查找入职员工时间排名倒数第三的员工所有信息，为了减轻入门难度，目前所有的数据里</h3><h3 id="员工入职的日期都不是同一天"><a href="#员工入职的日期都不是同一天" class="headerlink" title="员工入职的日期都不是同一天"></a>员工入职的日期都不是同一天</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE &#96;employees&#96; (</span><br><span class="line">&#96;emp_no&#96; int(11) NOT NULL,</span><br><span class="line">&#96;birth_date&#96; date NOT NULL,</span><br><span class="line">&#96;first_name&#96; varchar(14) NOT NULL,</span><br><span class="line">&#96;last_name&#96; varchar(16) NOT NULL,</span><br><span class="line">&#96;gender&#96; char(1) NOT NULL,</span><br><span class="line">&#96;hire_date&#96; date NOT NULL,</span><br><span class="line">PRIMARY KEY (&#96;emp_no&#96;));</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from employees</span><br><span class="line">where hire_date &#x3D; (</span><br><span class="line">select distinct hire_date</span><br><span class="line">from employees</span><br><span class="line">order by hire_date desc</span><br><span class="line">limit 2,</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h1 id="02-查找入职员工时间排名倒数第三的员工所有信息"><a href="#02-查找入职员工时间排名倒数第三的员工所有信息" class="headerlink" title="02.查找入职员工时间排名倒数第三的员工所有信息"></a>02.查找入职员工时间排名倒数第三的员工所有信息</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找各个部门当前(to_date=’9999- 01 - 01’)领导当前薪水详情以及其对应部门编号dept_no(请注</p>
<p>意输出结果，dept_no列是最后一列)</p>
<p>CREATE TABLE <code>dept_manager</code> (</p>
<p><code>dept_no</code> char(4) NOT NULL comment ‘部门编号’,</p>
<p><code>emp_no</code> int(11) NOT NULL comment ‘员工编号’,</p>
<p><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>salaries</code> (</p>
<p><code>emp_no</code> int(11) NOT NULL comment ‘员工编号’,</p>
<p><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select s.*, d.dept_no<br>from salaries s<br>inner join dept_manager d<br>on s.emp_no = d.emp_no<br>where s.to_date=’9999- 01 - 01’<br>and d.to_date=’9999- 01 - 01’;</p>
<h1 id="03-查找各个部门当前领导当前薪水详情以及其对应部"><a href="#03-查找各个部门当前领导当前薪水详情以及其对应部" class="headerlink" title="03.查找各个部门当前领导当前薪水详情以及其对应部"></a>03.查找各个部门当前领导当前薪水详情以及其对应部</h1><h1 id="门编号dept-no"><a href="#门编号dept-no" class="headerlink" title="门编号dept_no"></a>门编号dept_no</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找所有已经分配部门的员工的last_name和first_name以及dept_no(请注意输出描述里各个列</p>
<p>的前后顺序)</p>
<p>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>select last_name,first_name,dept_no<br>from employees e<br>inner join dept_emp d<br>on e.emp_no = d.emp_no;</p>
<h1 id="04-查找所有已经分配部门的员工的last-name和"><a href="#04-查找所有已经分配部门的员工的last-name和" class="headerlink" title="04.查找所有已经分配部门的员工的last_name和"></a>04.查找所有已经分配部门的员工的last_name和</h1><h1 id="first-name"><a href="#first-name" class="headerlink" title="first_name"></a>first_name</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-3"><a href="#题目描述-3" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找所有员工的last_name和first_name以及对应部门编号dept_no，也包括暂时没有分配具体</p>
<p>部门的员工(请注意输出描述里各个列的前后顺序)</p>
<p>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>select last_name,first_name,dept_no<br>from employees e<br>left join dept_emp d<br>on e.emp_no = d.emp_no;</p>
<h3 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h3><h3 id="INNER-JOIN-两边表同时有对应的数据，即任何一边缺失数据就不显示。"><a href="#INNER-JOIN-两边表同时有对应的数据，即任何一边缺失数据就不显示。" class="headerlink" title="INNER JOIN 两边表同时有对应的数据，即任何一边缺失数据就不显示。"></a>INNER JOIN 两边表同时有对应的数据，即任何一边缺失数据就不显示。</h3><h3 id="主LEFT-JOIN-从-会读取左边数据表的全部数据，即便右边表无对应数据。"><a href="#主LEFT-JOIN-从-会读取左边数据表的全部数据，即便右边表无对应数据。" class="headerlink" title="主LEFT JOIN 从 会读取左边数据表的全部数据，即便右边表无对应数据。"></a>主LEFT JOIN 从 会读取左边数据表的全部数据，即便右边表无对应数据。</h3><h3 id="从RIGHT-JOIN-主-会读取右边数据表的全部数据，即便左边表无对应数据。"><a href="#从RIGHT-JOIN-主-会读取右边数据表的全部数据，即便左边表无对应数据。" class="headerlink" title="从RIGHT JOIN 主 会读取右边数据表的全部数据，即便左边表无对应数据。"></a>从RIGHT JOIN 主 会读取右边数据表的全部数据，即便左边表无对应数据。</h3><h1 id="05-查找所有员工的last-name和first-name以及对应部"><a href="#05-查找所有员工的last-name和first-name以及对应部" class="headerlink" title="05.查找所有员工的last_name和first_name以及对应部"></a>05.查找所有员工的last_name和first_name以及对应部</h1><h1 id="门编号dept-no-1"><a href="#门编号dept-no-1" class="headerlink" title="门编号dept_no"></a>门编号dept_no</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-4"><a href="#题目描述-4" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找所有员工入职时候的薪水情况，给出emp_no以及salary， 并按照emp_no进行逆序(请注</p>
<p>意，一个员工可能有多次涨薪的情况)</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,</p>
<p><code>hire_date</code> date NOT NULL,#入职</p>
<p>PRIMARY KEY (<code>emp_no</code>));</p>
<p>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,</p>
<p><code>from_date</code> date NOT NULL,#入职日期=from_date</p>
<p><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select e.emp_no, s.salary<br>from employees e<br>inner join salaries s<br>on e.emp_no = s.emp_no<br>where e.hire_date = s.from_date<br>order by e.emp_no desc;</p>
<h1 id="06-查找所有员工入职时候的薪水情况"><a href="#06-查找所有员工入职时候的薪水情况" class="headerlink" title="06.查找所有员工入职时候的薪水情况"></a>06.查找所有员工入职时候的薪水情况</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-5"><a href="#题目描述-5" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找薪水涨幅超过 15 次的员工号emp_no以及其对应的涨幅次数t</p>
<p>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select s.emp_no, count(<em>) t<br>from salaries s<br>group by s.emp_no<br>having count(</em>) &gt; 15;</p>
<h1 id="07-查找薪水涨幅超过-15-次的员工号emp-no以及其对"><a href="#07-查找薪水涨幅超过-15-次的员工号emp-no以及其对" class="headerlink" title="07.查找薪水涨幅超过 15 次的员工号emp_no以及其对"></a>07.查找薪水涨幅超过 15 次的员工号emp_no以及其对</h1><h1 id="应的涨幅次数t"><a href="#应的涨幅次数t" class="headerlink" title="应的涨幅次数t"></a>应的涨幅次数t</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-6"><a href="#题目描述-6" class="headerlink" title="题目描述"></a>题目描述</h3><p>找出所有员工当前(to_date=’9999- 01 - 01’)具体的薪水salary情况，对于相同的薪水只显示一次,</p>
<p>并按照逆序显示</p>
<p>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select distinct salary<br>from salaries s<br>where s.to_date=’9999- 01 - 01’<br>order by salary desc;</p>
<p>select salary<br>from salaries s<br>where s.to_date=’9999- 01 - 01’<br>group by salary<br>order by salary desc;</p>
<h1 id="08-找出所有员工当前具体的薪水salary情况"><a href="#08-找出所有员工当前具体的薪水salary情况" class="headerlink" title="08.找出所有员工当前具体的薪水salary情况"></a>08.找出所有员工当前具体的薪水salary情况</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-7"><a href="#题目描述-7" class="headerlink" title="题目描述"></a>题目描述</h3><p>获取所有部门当前manager的当前薪水情况，给出dept_no, emp_no以及salary，当前表示</p>
<p>to_date=’9999- 01 - 01’<br>CREATE TABLE <code>dept_manager</code> (<br><code>dept_no</code> char(4) NOT NULL,<br><code>emp_no</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select d.dept_no, d.emp_no, s.salary<br>from dept_manager d<br>inner join salaries s<br>on d.emp_no = s.emp_no<br>where d.to_date=’9999- 01 - 01’<br>and s.to_date=’9999- 01 - 01’;</p>
<h1 id="09-获取所有部门当前manager的当前薪水情况"><a href="#09-获取所有部门当前manager的当前薪水情况" class="headerlink" title="09.获取所有部门当前manager的当前薪水情况"></a>09.获取所有部门当前manager的当前薪水情况</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-8"><a href="#题目描述-8" class="headerlink" title="题目描述"></a>题目描述</h3><p>获取所有非manager的员工emp_no</p>
<p>CREATE TABLE <code>dept_manager</code> (<br><code>dept_no</code> char(4) NOT NULL,<br><code>emp_no</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>select emp_no<br>from employees<br>where emp_no not in(<br>select e.emp_no<br>from employees e<br>inner join dept_manager d<br>on e.emp_no = d.emp_no<br>);</p>
<h1 id="10-获取所有非manager的员工emp-no"><a href="#10-获取所有非manager的员工emp-no" class="headerlink" title="10.获取所有非manager的员工emp_no"></a>10.获取所有非manager的员工emp_no</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-9"><a href="#题目描述-9" class="headerlink" title="题目描述"></a>题目描述</h3><p>获取所有员工当前的manager，如果当前的manager是自己的话结果不显示，当前表示</p>
<p>to_date=’9999- 01 - 01’。</p>
<p>结果第一列给出当前员工的emp_no,第二列给出其manager对应的manager_no。</p>
<p>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>dept_manager</code> (<br><code>dept_no</code> char(4) NOT NULL,<br><code>emp_no</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));</p>
<p>select e.emp_no, m.emp_no<br>from dept_emp e<br>inner join dept_manager m<br>on e.dept_no = m.dept_no<br>where e.emp_no &lt;&gt; m.emp_no<br>and e.to_date=’9999- 01 - 01’<br>and m.to_date=’9999- 01 - 01’;</p>
<h1 id="11-获取所有员工当前的manager"><a href="#11-获取所有员工当前的manager" class="headerlink" title="11.获取所有员工当前的manager"></a>11.获取所有员工当前的manager</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-10"><a href="#题目描述-10" class="headerlink" title="题目描述"></a>题目描述</h3><p>获取所有部门中当前员工薪水最高的相关信息，给出dept_no, emp_no以及其对应的salary</p>
<p>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select d.dept_no, d.emp_no, max(salary)<br>from dept_emp d<br>inner join salaries s<br>on d.emp_no = s.emp_no<br>where d.to_date = ‘9999- 01 - 01’<br>and s.to_date = ‘9999- 01 - 01’<br>group by d.dept_no;</p>
<h1 id="12-获取所有部门中当前员工薪水最高的相关信息"><a href="#12-获取所有部门中当前员工薪水最高的相关信息" class="headerlink" title="12.获取所有部门中当前员工薪水最高的相关信息"></a>12.获取所有部门中当前员工薪水最高的相关信息</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-11"><a href="#题目描述-11" class="headerlink" title="题目描述"></a>题目描述</h3><p>从titles表获取按照title进行分组，每组个数大于等于 2 ，给出title以及对应的数目t。</p>
<p>CREATE TABLE IF NOT EXISTS “titles” (<br><code>emp_no</code> int(11) NOT NULL,<br><code>title</code> varchar(50) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date DEFAULT NULL);</p>
<p>select title, count(<em>) t<br>from titles<br>group by title<br>having count(</em>) &gt;= 2;</p>
<h1 id="13-从titles表获取按照title进行分组"><a href="#13-从titles表获取按照title进行分组" class="headerlink" title="13.从titles表获取按照title进行分组"></a>13.从titles表获取按照title进行分组</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-12"><a href="#题目描述-12" class="headerlink" title="题目描述"></a>题目描述</h3><p>从titles表获取按照title进行分组，每组个数大于等于 2 ，给出title以及对应的数目t。</p>
<p>注意对于重复的emp_no进行忽略。</p>
<p>CREATE TABLE IF NOT EXISTS <code>titles</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>title</code> varchar(50) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date DEFAULT NULL);</p>
<p>select title, count(distinct emp_no) t<br>from titles<br>group by title<br>having t &gt;= 2;</p>
<h1 id="14-从titles表获取按照title进行分组，注意对于重复的"><a href="#14-从titles表获取按照title进行分组，注意对于重复的" class="headerlink" title="14.从titles表获取按照title进行分组，注意对于重复的"></a>14.从titles表获取按照title进行分组，注意对于重复的</h1><h1 id="emp-no进行忽略"><a href="#emp-no进行忽略" class="headerlink" title="emp_no进行忽略"></a>emp_no进行忽略</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-13"><a href="#题目描述-13" class="headerlink" title="题目描述"></a>题目描述</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">查找employees表所有emp_no为奇数，且last_name不为Mary的员工信息，并按照hire_date</span><br><span class="line">逆序排列</span><br><span class="line">CREATE TABLE &#96;employees&#96; (</span><br><span class="line">&#96;emp_no&#96; int(11) NOT NULL,</span><br><span class="line">&#96;birth_date&#96; date NOT NULL,</span><br><span class="line">&#96;first_name&#96; varchar(14) NOT NULL,</span><br><span class="line">&#96;last_name&#96; varchar(16) NOT NULL,</span><br><span class="line">&#96;gender&#96; char(1) NOT NULL,</span><br><span class="line">&#96;hire_date&#96; date NOT NULL,</span><br><span class="line">PRIMARY KEY (&#96;emp_no&#96;));</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from employees e</span><br><span class="line">where e.emp_no &amp; 1 &#x3D; 1</span><br><span class="line">and e.last_name !&#x3D; &#39;Mary&#39;</span><br><span class="line">order by e.hire_date desc;</span><br></pre></td></tr></table></figure>
<h1 id="15-查找employees表所有emp-no为奇数"><a href="#15-查找employees表所有emp-no为奇数" class="headerlink" title="15.查找employees表所有emp_no为奇数"></a>15.查找employees表所有emp_no为奇数</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-14"><a href="#题目描述-14" class="headerlink" title="题目描述"></a>题目描述</h3><p>统计出当前各个title类型对应的员工当前（to_date=’9999- 01 - 01’）薪水对应的平均工资。结果</p>
<p>给出title以及平均工资avg。</p>
<p>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));<br>CREATE TABLE IF NOT EXISTS “titles” (<br><code>emp_no</code> int(11) NOT NULL,<br><code>title</code> varchar(50) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date DEFAULT NULL);</p>
<p>select t.title, avg(s.salary) avg<br>from titles t<br>inner join salaries s<br>on t.emp_no = s.emp_no<br>where t.to_date=’9999- 01 - 01’<br>and s.to_date=’9999- 01 - 01’<br>group by t.title;</p>
<h1 id="16-统计出当前各个title类型对应的员工当前薪水对应"><a href="#16-统计出当前各个title类型对应的员工当前薪水对应" class="headerlink" title="16.统计出当前各个title类型对应的员工当前薪水对应"></a>16.统计出当前各个title类型对应的员工当前薪水对应</h1><h1 id="的平均工资"><a href="#的平均工资" class="headerlink" title="的平均工资"></a>的平均工资</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-15"><a href="#题目描述-15" class="headerlink" title="题目描述"></a>题目描述</h3><p>获取当前（to_date=’9999- 01 - 01’）薪水第二多的员工的emp_no以及其对应的薪水salary</p>
<p>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select emp_no,salary<br>from salaries<br>where to_date=’9999- 01 - 01’<br>and salary = (<br>select distinct salary<br>from salaries<br>order by salary desc<br>limit 1,<br>);</p>
<h1 id="17-获取当前薪水第二多的员工的emp-no以及其对应"><a href="#17-获取当前薪水第二多的员工的emp-no以及其对应" class="headerlink" title="17.获取当前薪水第二多的员工的emp_no以及其对应"></a>17.获取当前薪水第二多的员工的emp_no以及其对应</h1><h1 id="的薪水salary"><a href="#的薪水salary" class="headerlink" title="的薪水salary"></a>的薪水salary</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-16"><a href="#题目描述-16" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找当前薪水(to_date=’9999- 01 - 01’)排名第二多的</p>
<p>员工编号emp_no、薪水salary、last_name以及first_name，不准使用order by</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));<br>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select e.emp_no, max(s.salary), e.last_name, e.first_name<br>from employees e<br>inner join salaries s<br>on e.emp_no = s.emp_no<br>where s.to_date = ‘9999- 01 - 01’<br>and s.salary not in(<br>select max(salary)<br>from salaries<br>where to_date = ‘9999- 01 - 01’<br>);</p>
<h1 id="18-查找当前薪水排名第二多的员工编号emp-no"><a href="#18-查找当前薪水排名第二多的员工编号emp-no" class="headerlink" title="18.查找当前薪水排名第二多的员工编号emp_no"></a>18.查找当前薪水排名第二多的员工编号emp_no</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-17"><a href="#题目描述-17" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找所有员工的last_name和first_name以及对应的dept_name，</p>
<p>也包括暂时没有分配部门的员工left join</p>
<p>CREATE TABLE <code>departments</code> (<br><code>dept_no</code> char(4) NOT NULL,<br><code>dept_name</code> varchar(40) NOT NULL,<br>PRIMARY KEY (<code>dept_no</code>));</p>
<p>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>select last_name,first_name,dept_name<br>from employees e<br>left join dept_emp de on e.emp_no = de.emp_no<br>left join departments d on d.dept_no = de.dept_no;</p>
<h1 id="19-查找所有员工的last-name和first-name以及对应的"><a href="#19-查找所有员工的last-name和first-name以及对应的" class="headerlink" title="19.查找所有员工的last_name和first_name以及对应的"></a>19.查找所有员工的last_name和first_name以及对应的</h1><h1 id="dept-name"><a href="#dept-name" class="headerlink" title="dept_name"></a>dept_name</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-18"><a href="#题目描述-18" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找员工编号emp_no为 10001 其自入职以来的薪水salary涨幅值growth</p>
<p>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select<br>(</p>
<p>#最近的-刚入职的</p>
<p>(select salary from salaries where emp_no = 10001 order by salary desc)</p>
<ul>
<li>(select salary from salaries where emp_no = 10001 order by salary)<br>) growth;</li>
</ul>
<h1 id="20-查找员工编号emp-now为-10001-其自入职以来的薪"><a href="#20-查找员工编号emp-now为-10001-其自入职以来的薪" class="headerlink" title="20.查找员工编号emp_now为 10001 其自入职以来的薪"></a>20.查找员工编号emp_now为 10001 其自入职以来的薪</h1><h1 id="水salary涨幅值growth"><a href="#水salary涨幅值growth" class="headerlink" title="水salary涨幅值growth"></a>水salary涨幅值growth</h1><p>2020 年 5 月 18 日 8:</p>
<h3 id="题目描述-19"><a href="#题目描述-19" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找所有员工自入职以来的薪水涨幅情况，给出员工编号emp_no以及其对应的薪水涨幅</p>
<p>growth，并按照growth进行升序</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));<br>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select e.emp_no, (s1.salary -s2.salary) as growth<br>from employees e<br>inner join salaries s1</p>
<p>on e.emp_no = s1.emp_no and s1.to_date = ‘9999- 01 - 01’#当前薪资</p>
<p>inner join salaries s2</p>
<p>on e.emp_no = s2.emp_no and e.hire_date = s2.from_date#入职薪资</p>
<p>order by growth asc;</p>
<h1 id="21-查找所有员工自入职以来的薪水涨幅情况"><a href="#21-查找所有员工自入职以来的薪水涨幅情况" class="headerlink" title="21.查找所有员工自入职以来的薪水涨幅情况"></a>21.查找所有员工自入职以来的薪水涨幅情况</h1><p>2020 年 5 月 18 日 8:47</p>
<h3 id="题目描述-20"><a href="#题目描述-20" class="headerlink" title="题目描述"></a>题目描述</h3><p>统计各个部门的工资记录数，给出部门编码dept_no、部门名称dept_name以及次数sum</p>
<p>CREATE TABLE <code>departments</code> (<br><code>dept_no</code> char(4) NOT NULL,<br><code>dept_name</code> varchar(40) NOT NULL,<br>PRIMARY KEY (<code>dept_no</code>));<br>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select d.dept_no, d.dept_name,count(s.salary) ‘sum’<br>from departments d<br>inner join dept_emp de on d.dept_no = de.dept_no<br>inner join salaries s on de.emp_no = s.emp_no<br>group by d.dept_no;</p>
<h1 id="22-统计各个部门对应员工涨幅的次数总和"><a href="#22-统计各个部门对应员工涨幅的次数总和" class="headerlink" title="22.统计各个部门对应员工涨幅的次数总和"></a>22.统计各个部门对应员工涨幅的次数总和</h1><p>2020 年 5 月 18 日 8:47</p>
<h3 id="题目描述-21"><a href="#题目描述-21" class="headerlink" title="题目描述"></a>题目描述</h3><p>对所有员工的当前(to_date=’9999- 01 - 01’)薪水按照salary进行按照 1 - N的排名，</p>
<p>相同salary并列且按照emp_no升序排列</p>
<p>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p><strong>输出描述:</strong></p>
<p>emp_no salary rank</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10005 94692 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10009 94409 2</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10010 94409 2</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10001 88958 3</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10007 88070 4</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10004 74057 5</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10002 72527 6</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10003 43311 7</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10006 43311 7</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10011 25828 8</span><br></pre></td></tr></table></figure>
<p>来自&lt;<a href="https://www.nowcoder.com/practice/b9068bfe5df74276bd015b9729eec4bf?tpId=82&amp;tqId=29775&amp;tPage=2" target="_blank" rel="noopener">https://www.nowcoder.com/practice/b9068bfe5df74276bd015b9729eec4bf?tpId=82&amp;tqId=29775&amp;tPage=2</a><br>&amp;rp=&amp;ru=/ta/sql&amp;qru=/ta/sql/question-ranking&gt;</p>
<p>select s1.emp_no, s1.salary, count(distinct s2.salary) rank<br>from salaries s1, salaries s2<br>where s1.to_date=’9999- 01 - 01’<br>and s2.to_date=’9999- 01 - 01’<br>and s1.salary &lt;= s2.salary<br>group by s1.emp_no<br>order by s1.salary desc,s1.emp_no asc</p>
<h1 id="23-对所有员工的当前薪水按照salary进行按照-1-N的排"><a href="#23-对所有员工的当前薪水按照salary进行按照-1-N的排" class="headerlink" title="23.对所有员工的当前薪水按照salary进行按照 1 - N的排"></a>23.对所有员工的当前薪水按照salary进行按照 1 - N的排</h1><h1 id="名"><a href="#名" class="headerlink" title="名"></a>名</h1><p>2020 年 5 月 18 日 8:47</p>
<h3 id="题目描述-22"><a href="#题目描述-22" class="headerlink" title="题目描述"></a>题目描述</h3><p>获取所有非manager员工当前的薪水情况，给出dept_no、emp_no以及salary ，</p>
<p>当前表示to_date=’9999- 01 - 01’</p>
<p>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));</p>
<p>CREATE TABLE <code>dept_manager</code> (<br><code>dept_no</code> char(4) NOT NULL,<br><code>emp_no</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<h3 id="1-查询所有员工的情况"><a href="#1-查询所有员工的情况" class="headerlink" title="1.查询所有员工的情况"></a>1.查询所有员工的情况</h3><p>2.筛选掉manager员工</p>
<p>select de.dept_no,e.emp_no,s.salary<br>from employees e<br>inner join salaries s<br>on e.emp_no = s.emp_no and s.to_date=’9999- 01 - 01’<br>inner join dept_emp de<br>on e.emp_no = de.emp_no<br>where de.emp_no not in(<br>select emp_no<br>from dept_manager dm<br>where dm.to_date=’9999- 01 - 01’<br>);</p>
<h1 id="24-获取所有非manager员工当前的薪水情况"><a href="#24-获取所有非manager员工当前的薪水情况" class="headerlink" title="24.获取所有非manager员工当前的薪水情况"></a>24.获取所有非manager员工当前的薪水情况</h1><p>2020 年 5 月 18 日 8:47</p>
<h3 id="题目描述-23"><a href="#题目描述-23" class="headerlink" title="题目描述"></a>题目描述</h3><p>获取员工其当前的薪水比其manager当前薪水还高的相关信息，当前表示to_date=’9999- 01 - 01’,</p>
<p>结果第一列给出员工的emp_no，</p>
<p>第二列给出其manager的manager_no，</p>
<p>第三列给出该员工当前的薪水emp_salary,</p>
<p>第四列给该员工对应的manager当前的薪水manager_salary</p>
<p>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>dept_manager</code> (<br><code>dept_no</code> char(4) NOT NULL,<br><code>emp_no</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select de.emp_no emp_no,dm.emp_no manager_no,s1.salary emp_salary,s2.salary manager_salary<br>from dept_emp de, salaries s1, dept_manager dm, salaries s2<br>where de.emp_no = s1.emp_no<br>and s1.to_date=’9999- 01 - 01’<br>and de.to_date=’9999- 01 - 01’<br>and dm.emp_no = s2.emp_no<br>and s2.to_date=’9999- 01 - 01’<br>and dm.to_date=’9999- 01 - 01’<br>and de.dept_no = dm.dept_no<br>and s1.salary &gt; s2.salary;</p>
<h1 id="25-获取员工其当前的薪水比其manager当前薪水还高"><a href="#25-获取员工其当前的薪水比其manager当前薪水还高" class="headerlink" title="25.获取员工其当前的薪水比其manager当前薪水还高"></a>25.获取员工其当前的薪水比其manager当前薪水还高</h1><h1 id="的相关信息"><a href="#的相关信息" class="headerlink" title="的相关信息"></a>的相关信息</h1><p>2020 年 5 月 18 日 8:47</p>
<h3 id="题目描述-24"><a href="#题目描述-24" class="headerlink" title="题目描述"></a>题目描述</h3><p>汇总各个部门当前员工的title类型的分配数目，结果给出部门编号dept_no、dept_name、其当</p>
<p>前员工所有的title以及该类型title对应的数目count</p>
<p>CREATE TABLE <code>departments</code> (<br><code>dept_no</code> char(4) NOT NULL,<br><code>dept_name</code> varchar(40) NOT NULL,<br>PRIMARY KEY (<code>dept_no</code>));<br>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE IF NOT EXISTS <code>titles</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>title</code> varchar(50) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date DEFAULT NULL);</p>
<h3 id="输出描述"><a href="#输出描述" class="headerlink" title="输出描述:"></a>输出描述:</h3><p>dept_no dept_name title count</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d001 Marketing Senior Engineer 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d001 Marketing Staff 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d002 Finance Senior Engineer 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d003 Human Resources Senior Staff 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d004 Production Senior Engineer 2</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d005 Development Senior Staff 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d006 Quality Management Engineer 2</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d006 Quality Management Senior Engineer 1</span><br></pre></td></tr></table></figure>
<p>来自&lt;<a href="https://www.nowcoder.com/practice/4bcb6a7d3e39423291d2f7bdbbff87f8?tpId=82&amp;tqId=29778&amp;tPage=2" target="_blank" rel="noopener">https://www.nowcoder.com/practice/4bcb6a7d3e39423291d2f7bdbbff87f8?tpId=82&amp;tqId=29778&amp;tPage=2</a><br>&amp;rp=&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&gt;</p>
<p>select de.dept_no,d.dept_name,t.title,count(t.title) ‘count’<br>from dept_emp de<br>inner join titles t<br>on de.emp_no = t.emp_no<br>and de.to_date=’9999- 01 - 01’<br>and t.to_date=’9999- 01 - 01’<br>inner join departments d</p>
<h1 id="26-汇总各个部门当前员工的title类型的分配数目"><a href="#26-汇总各个部门当前员工的title类型的分配数目" class="headerlink" title="26.汇总各个部门当前员工的title类型的分配数目"></a>26.汇总各个部门当前员工的title类型的分配数目</h1><p>2020 年 5 月 18 日 8:47</p>
<p>inner join departments d<br>on de.dept_no = d.dept_no<br>group by de.dept_no, t.title;</p>
<h3 id="题目描述-25"><a href="#题目描述-25" class="headerlink" title="题目描述"></a>题目描述</h3><p>给出每个员工每年薪水涨幅超过 5000 的员工编号emp_no、薪水变更开始日期from_date以及薪</p>
<p>水涨幅值salary_growth，并按照salary_growth逆序排列。</p>
<p>提示：在sqlite中获取datetime时间对应的年份函数为strftime(‘%Y’, to_date)</p>
<p>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>select s2.emp_no,s2.from_date,(s2.salary -s1.salary) salary_growth<br>from salaries s1, salaries s2<br>where s1.emp_no = s2.emp_no<br>and salary_growth &gt; 5000<br>and (strftime(‘%Y’, s2.to_date) -strftime(‘%Y’, s1.to_date) = 1<br>or strftime(‘%Y’, s2.from_date) -strftime(‘%Y’, s1.from_date) = 1)<br>order by salary_growth desc;</p>
<h1 id="27-给出每个员工每年薪水涨幅超过-5000-的员工编号"><a href="#27-给出每个员工每年薪水涨幅超过-5000-的员工编号" class="headerlink" title="27.给出每个员工每年薪水涨幅超过 5000 的员工编号"></a>27.给出每个员工每年薪水涨幅超过 5000 的员工编号</h1><h1 id="emp-no"><a href="#emp-no" class="headerlink" title="emp_no"></a>emp_no</h1><p>2020 年 5 月 18 日 8:47</p>
<h2 id="题目描述-26"><a href="#题目描述-26" class="headerlink" title="题目描述"></a>题目描述</h2><p>film表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字段 说明</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">film_id 电影id</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">title 电影名称</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">description 电影描述信息</span><br></pre></td></tr></table></figure>
<p>CREATE TABLE IF NOT EXISTS film (</p>
<p>film_id smallint(5) NOT NULL DEFAULT ‘0’,</p>
<p>title varchar(255) NOT NULL,</p>
<p>description text,</p>
<p>PRIMARY KEY (film_id));</p>
<p>category表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字段 说明</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">category_id 电影分类id</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name 电影分类名称</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last_update 电影分类最后更新时间</span><br></pre></td></tr></table></figure>
<p>CREATE TABLE category (</p>
<p>category_id tinyint(3) NOT NULL ,</p>
<p>name varchar(25) NOT NULL, <code>last_update</code> timestamp,</p>
<p>PRIMARY KEY ( category_id ));</p>
<p>film_category表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字段 说明</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">film_id 电影id</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">category_id 电影分类id</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last_update 电影id和分类id对应关系的最后更新时间</span><br></pre></td></tr></table></figure>
<p>CREATE TABLE film_category (</p>
<p>film_id smallint(5) NOT NULL,</p>
<p>category_id tinyint(3) NOT NULL, <code>last_update</code> timestamp);</p>
<p>查找描述信息中包括robot的电影对应的分类名称以及电影数目，而且还需要该分类对应电影数</p>
<p>量&gt;=5部</p>
<p>来自&lt;<a href="https://www.nowcoder.com/practice/3a303a39cc40489b99a7e1867e6507c5?tpId=82&amp;tqId=29780&amp;tPage=2" target="_blank" rel="noopener">https://www.nowcoder.com/practice/3a303a39cc40489b99a7e1867e6507c5?tpId=82&amp;tqId=29780&amp;tPage=2</a><br>&amp;rp=&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&gt;</p>
<h1 id="28-查找描述信息中包括robot的电影对应的分类名称"><a href="#28-查找描述信息中包括robot的电影对应的分类名称" class="headerlink" title="28.查找描述信息中包括robot的电影对应的分类名称"></a>28.查找描述信息中包括robot的电影对应的分类名称</h1><h1 id="以及电影数目"><a href="#以及电影数目" class="headerlink" title="以及电影数目"></a>以及电影数目</h1><p>2020 年 5 月 18 日 8:47</p>
<p>&amp;rp=&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&gt;</p>
<p>查找描述信息中包括robot的电影对应的分类名称以及电影数目，而且还需要该分类对应电影</p>
<p>数量&gt;=5部</p>
<p>CREATE TABLE IF NOT EXISTS film (<br>film_id smallint(5) NOT NULL DEFAULT ‘0’,<br>title varchar(255) NOT NULL,</p>
<p>description text, #描述信息like ‘%robot%’</p>
<p>PRIMARY KEY (film_id));</p>
<p>CREATE TABLE category (<br>category_id tinyint(3) NOT NULL ,</p>
<p>name varchar(25) NOT NULL, <code>last_update</code> timestamp, #分类名称</p>
<p>PRIMARY KEY ( category_id ));</p>
<p>CREATE TABLE film_category (<br>film_id smallint(5) NOT NULL,<br>category_id tinyint(3) NOT NULL, <code>last_update</code> timestamp);</p>
<p>select c.name,count(fc.film_id) num<br>from category c<br>inner join film_category fc<br>on c.category_id = fc.category_id<br>inner join(<br>select *<br>from film f<br>where f.description like ‘%robot%’<br>) f_robot on f_robot.film_id = fc.film_id<br>inner join(<br>select *,count(fc1.film_id) num1<br>from film_category fc1<br>group by category_id<br>having num1 &gt;= 5<br>) f5 on f5.category_id = fc.category_id;</p>
<p>使用join查询方式找出没有分类的电影id以及名称</p>
<p>CREATE TABLE IF NOT EXISTS film (<br>film_id smallint(5) NOT NULL DEFAULT ‘0’,<br>title varchar(255) NOT NULL,</p>
<p>description text, #描述信息like ‘%robot%’</p>
<p>PRIMARY KEY (film_id));</p>
<p>CREATE TABLE category (<br>category_id tinyint(3) NOT NULL ,</p>
<p>name varchar(25) NOT NULL, <code>last_update</code> timestamp, #分类名称</p>
<p>PRIMARY KEY ( category_id ));</p>
<p>CREATE TABLE film_category (<br>film_id smallint(5) NOT NULL,<br>category_id tinyint(3) NOT NULL, <code>last_update</code> timestamp);</p>
<p>select f.film_id, f.title<br>from film f<br>left join film_category fc<br>on f.film_id = fc.film_id<br>where fc.category_id is null;</p>
<h1 id="29-使用join查询方式找出没有分类的电影id以及名称"><a href="#29-使用join查询方式找出没有分类的电影id以及名称" class="headerlink" title="29.使用join查询方式找出没有分类的电影id以及名称"></a>29.使用join查询方式找出没有分类的电影id以及名称</h1><p>2020 年 5 月 18 日 8:47</p>
<p>使用子查询的方式找出属于Action分类的所有电影对应的title,description</p>
<p>CREATE TABLE IF NOT EXISTS film (<br>film_id smallint(5) NOT NULL DEFAULT ‘0’,<br>title varchar(255) NOT NULL,<br>description text,<br>PRIMARY KEY (film_id));</p>
<p>CREATE TABLE category (<br>category_id tinyint(3) NOT NULL ,</p>
<p>name varchar(25) NOT NULL, <code>last_update</code> timestamp, #分类名称</p>
<p>PRIMARY KEY ( category_id ));</p>
<p>CREATE TABLE film_category (<br>film_id smallint(5) NOT NULL,<br>category_id tinyint(3) NOT NULL, <code>last_update</code> timestamp);</p>
<p>select f.title, f.description<br>from film f<br>where f.film_id in(<br>select film_id<br>from film_category fc<br>where fc.category_id in(<br>select c.category_id<br>from category c<br>where c.name=’Action’<br>)<br>);</p>
<h1 id="30-使用子查询的方式找出属于Action分类的所有电影"><a href="#30-使用子查询的方式找出属于Action分类的所有电影" class="headerlink" title="30.使用子查询的方式找出属于Action分类的所有电影"></a>30.使用子查询的方式找出属于Action分类的所有电影</h1><h1 id="对应的title-description"><a href="#对应的title-description" class="headerlink" title="对应的title,description"></a>对应的title,description</h1><p>2020 年 5 月 18 日 8:47</p>
<h3 id="题目描述-27"><a href="#题目描述-27" class="headerlink" title="题目描述"></a>题目描述</h3><p>获取select * from employees对应的执行计划</p>
<p>explain select * from employees;</p>
<h1 id="31-获取select"><a href="#31-获取select" class="headerlink" title="31.获取select"></a>31.获取select</h1><p>2020 年 5 月 18 日 18:14</p>
<h3 id="题目描述-28"><a href="#题目描述-28" class="headerlink" title="题目描述"></a>题目描述</h3><p>将employees表的所有员工的last_name和first_name拼接起来作为Name，中间以一个空格区分</p>
<p>CREATE TABLE <code>employees</code> ( <code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>select last_name||’ ‘||first_name as name<br>from employees;</p>
<h1 id="32-将employees表的所有员工的last-name和first-name"><a href="#32-将employees表的所有员工的last-name和first-name" class="headerlink" title="32.将employees表的所有员工的last_name和first_name"></a>32.将employees表的所有员工的last_name和first_name</h1><h1 id="拼接起来作为Name，中间以一个空格区分"><a href="#拼接起来作为Name，中间以一个空格区分" class="headerlink" title="拼接起来作为Name，中间以一个空格区分"></a>拼接起来作为Name，中间以一个空格区分</h1><p>2020 年 5 月 18 日 18:14</p>
<h3 id="题目描述-29"><a href="#题目描述-29" class="headerlink" title="题目描述"></a>题目描述</h3><p>创建一个actor表，包含如下列信息</p>
<p>列表 类型 是否为NULL 含义</p>
<p>actor_id smallint(5) not null主键id</p>
<p>first_name varchar(45) not null名字</p>
<p>last_name varchar(45) not null姓氏</p>
<p>last_update timestamp not null最后更新时间，默认是系统的当前时间</p>
<p>create table actor(<br>actor_id smallint(5) not null primary key,<br>first_name varchar(45) not null,<br>last_name varchar(45) not null,<br>last_update timestamp not null default (datetime(‘now’,’localtime’))<br>);</p>
<h1 id="33-创建一个actor表，包含如下列信息"><a href="#33-创建一个actor表，包含如下列信息" class="headerlink" title="33.创建一个actor表，包含如下列信息"></a>33.创建一个actor表，包含如下列信息</h1><p>2020 年 5 月 18 日 18:14</p>
<h3 id="题目描述-30"><a href="#题目描述-30" class="headerlink" title="题目描述"></a>题目描述</h3><p>对于表actor批量插入如下数据</p>
<p>CREATE TABLE IF NOT EXISTS actor (<br>actor_id smallint(5) NOT NULL PRIMARY KEY,<br>first_name varchar(45) NOT NULL,<br>last_name varchar(45) NOT NULL,<br>last_update timestamp NOT NULL DEFAULT (datetime(‘now’,’localtime’)))</p>
<p>actor_id first_name last_name last_update<br>1 PENELOPE GUINESS 2006 - 02 - 15 12:34:33<br>2 NICK WAHLBERG 2006 - 02 - 15 12:34:33</p>
<p>insert into actor<br>values (1, ‘PENELOPE’, ‘GUINESS’, ‘2006- 02 - 15 12:34:33’),<br>(2, ‘NICK’, ‘WAHLBERG’, ‘2006- 02 - 15 12:34:33’)</p>
<p>insert into actor<br>select 1,’PENELOPE’,’GUINESS’,’2006- 02 - 15 12:34:33’<br>union select 2,’NICK’,’WAHLBERG’,’2006- 02 - 15 12:34:33’;</p>
<h1 id="34-批量插入数据"><a href="#34-批量插入数据" class="headerlink" title="34.批量插入数据"></a>34.批量插入数据</h1><p>2020 年 5 月 18 日 18:14</p>
<h3 id="题目描述-31"><a href="#题目描述-31" class="headerlink" title="题目描述"></a>题目描述</h3><p>对于表actor批量插入如下数据,如果数据已经存在，请忽略，不使用replace操作</p>
<p>CREATE TABLE IF NOT EXISTS actor (<br>actor_id smallint(5) NOT NULL PRIMARY KEY,<br>first_name varchar(45) NOT NULL,<br>last_name varchar(45) NOT NULL,<br>last_update timestamp NOT NULL DEFAULT (datetime(‘now’,’localtime’)))</p>
<p>actor_id first_name last_name last_update<br>‘3’ ‘ED’ ‘CHASE’’2006- 02 - 15 12:34:33’</p>
<p>insert or ignore into actor<br>values (3,’ED’,’CHASE’,’2006- 02 - 15 12:34:33’);</p>
<h1 id="35-批量插入数据-如果数据已经存在，请忽略，不使"><a href="#35-批量插入数据-如果数据已经存在，请忽略，不使" class="headerlink" title="35.批量插入数据,如果数据已经存在，请忽略，不使"></a>35.批量插入数据,如果数据已经存在，请忽略，不使</h1><h1 id="用replace操作"><a href="#用replace操作" class="headerlink" title="用replace操作"></a>用replace操作</h1><p>2020 年 5 月 18 日 18:14</p>
<h3 id="题目描述-32"><a href="#题目描述-32" class="headerlink" title="题目描述"></a>题目描述</h3><p>对于如下表actor，其对应的数据为:</p>
<p>actor_id first_name last_name last_update<br>1 PENELOPE GUINESS 2006 - 02 - 15 12:34:33<br>2 NICK WAHLBERG 2006 - 02 - 15 12:34:33</p>
<p>创建一个actor_name表，将actor表中的所有first_name以及last_name导入改表。actor_name表</p>
<p>结构如下：</p>
<p>列表 类型 是否为NULL 含义</p>
<p>first_name varchar(45) not null名字</p>
<p>last_name varchar(45) not null姓氏</p>
<p>create table actor_name as<br>select first_name,last_name from actor;</p>
<h1 id="36-创建一个actor-name表，将actor表中的所有"><a href="#36-创建一个actor-name表，将actor表中的所有" class="headerlink" title="36.创建一个actor_name表，将actor表中的所有"></a>36.创建一个actor_name表，将actor表中的所有</h1><h1 id="first-name以及last-name导入改表"><a href="#first-name以及last-name导入改表" class="headerlink" title="first_name以及last_name导入改表"></a>first_name以及last_name导入改表</h1><p>2020 年 5 月 18 日 18:14</p>
<h3 id="题目描述-33"><a href="#题目描述-33" class="headerlink" title="题目描述"></a>题目描述</h3><p>针对如下表actor结构创建索引：</p>
<p>CREATE TABLE IF NOT EXISTS actor (<br>actor_id smallint(5) NOT NULL PRIMARY KEY,<br>first_name varchar(45) NOT NULL,<br>last_name varchar(45) NOT NULL,<br>last_update timestamp NOT NULL DEFAULT (datetime(‘now’,’localtime’)))</p>
<p>对first_name创建唯一索引uniq_idx_firstname，对last_name创建普通索引idx_lastname</p>
<p>create unique index uniq_idx_firstname on actor(first_name);<br>create index idx_lastname on actor(last_name);</p>
<h1 id="37-对first-name创建唯一索引uniq-idx-firstname，对"><a href="#37-对first-name创建唯一索引uniq-idx-firstname，对" class="headerlink" title="37.对first_name创建唯一索引uniq_idx_firstname，对"></a>37.对first_name创建唯一索引uniq_idx_firstname，对</h1><h1 id="last-name创建普通索引idx-lastname"><a href="#last-name创建普通索引idx-lastname" class="headerlink" title="last_name创建普通索引idx_lastname"></a>last_name创建普通索引idx_lastname</h1><p>2020 年 5 月 18 日 18:14</p>
<h3 id="题目描述-34"><a href="#题目描述-34" class="headerlink" title="题目描述"></a>题目描述</h3><p>针对actor表创建视图actor_name_view，</p>
<p>只包含first_name以及last_name两列，</p>
<p>并对这两列重新命名，first_name为first_name_v，last_name修改为last_name_v：</p>
<p>CREATE TABLE IF NOT EXISTS actor (<br>actor_id smallint(5) NOT NULL PRIMARY KEY,<br>first_name varchar(45) NOT NULL,<br>last_name varchar(45) NOT NULL,<br>last_update timestamp NOT NULL DEFAULT (datetime(‘now’,’localtime’)))</p>
<p>create view actor_name_view (first_name_v,last_name_v) as<br>select first_name, last_name from actor;</p>
<h1 id="38-针对actor表创建视图actor-name-view"><a href="#38-针对actor表创建视图actor-name-view" class="headerlink" title="38.针对actor表创建视图actor_name_view"></a>38.针对actor表创建视图actor_name_view</h1><p>2020 年 5 月 18 日 18:14</p>
<h3 id="题目描述-35"><a href="#题目描述-35" class="headerlink" title="题目描述"></a>题目描述</h3><p>针对salaries表emp_no字段创建索引idx_emp_no，查询emp_no为10005, 使用强制索引。</p>
<p>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));<br>create index idx_emp_no on salaries(emp_no);</p>
<p>select *<br>from salaries<br>indexed by idx_emp_no<br>where emp_no = 10005;</p>
<p>MYSQL中强制索引查询使用：FORCE INDEX(indexname);</p>
<p>SQLite中强制索引查询使用：INDEXED BY indexname;</p>
<p>来自<a href="https://www.nowcoder.com/profile/340487413/codeBookDetail?submissionId=36255256" target="_blank" rel="noopener">https://www.nowcoder.com/profile/340487413/codeBookDetail?submissionId=36255256</a></p>
<p>SQLite中，使用 INDEXED BY 语句进行强制索引查询，可参考：</p>
<p><a href="http://www.runoob.com/sqlite/sqlite-indexed-by.html" target="_blank" rel="noopener">http://www.runoob.com/sqlite/sqlite-indexed-by.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 SELECT * FROM salaries INDEXED BY idx_emp_no WHERE emp_no &#x3D; 10005</span><br></pre></td></tr></table></figure>
<p>MySQL中，使用 FORCE INDEX 语句进行强制索引查询，可参考：</p>
<p><a href="http://www.jb51.net/article/49807.htm" target="_blank" rel="noopener">http://www.jb51.net/article/49807.htm</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 SELECT * FROM salaries FORCE INDEX idx_emp_no WHERE emp_no &#x3D; 10005</span><br></pre></td></tr></table></figure>
<p>来自<a href="https://www.nowcoder.com/profile/340487413/codeBookDetail?submissionId=36255256" target="_blank" rel="noopener">https://www.nowcoder.com/profile/340487413/codeBookDetail?submissionId=36255256</a></p>
<h1 id="39-针对上面的salaries表emp-no字段创建索引"><a href="#39-针对上面的salaries表emp-no字段创建索引" class="headerlink" title="39.针对上面的salaries表emp_no字段创建索引"></a>39.针对上面的salaries表emp_no字段创建索引</h1><h1 id="idx-emp-no，查询emp-no为10005"><a href="#idx-emp-no，查询emp-no为10005" class="headerlink" title="idx_emp_no，查询emp_no为10005,"></a>idx_emp_no，查询emp_no为10005,</h1><p>2020 年 5 月 18 日 18:14</p>
<h3 id="题目描述-36"><a href="#题目描述-36" class="headerlink" title="题目描述"></a>题目描述</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">存在actor表，包含如下列信息：</span><br><span class="line">CREATE TABLE IF NOT EXISTS actor (</span><br><span class="line">actor_id smallint(5) NOT NULL PRIMARY KEY,</span><br><span class="line">first_name varchar(45) NOT NULL,</span><br><span class="line">last_name varchar(45) NOT NULL,</span><br><span class="line">last_update timestamp NOT NULL DEFAULT (datetime(&#39;now&#39;,&#39;localtime&#39;)));</span><br><span class="line">现在在last_update后面新增加一列名字为create_date, 类型为datetime, NOT NULL，默认值</span><br><span class="line">为&#39;0000 00:00:00&#39;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table actor add column create_date datetime not null default &#39;0000- 00 - 00 00:00:00&#39;;</span><br></pre></td></tr></table></figure>
<h1 id="40-在last-update后面新增加一列名字为create-date"><a href="#40-在last-update后面新增加一列名字为create-date" class="headerlink" title="40.在last_update后面新增加一列名字为create_date"></a>40.在last_update后面新增加一列名字为create_date</h1><p>2020 年 5 月 18 日 18:14</p>
<h3 id="题目描述-37"><a href="#题目描述-37" class="headerlink" title="题目描述"></a>题目描述</h3><p>构造一个触发器audit_log，在向employees_test表中插入一条数据的时候，触发插入相关的数</p>
<p>据到audit中。</p>
<p>CREATE TABLE employees_test(<br>ID INT PRIMARY KEY NOT NULL,<br>NAME TEXT NOT NULL,<br>AGE INT NOT NULL,<br>ADDRESS CHAR(50),<br>SALARY REAL<br>);<br>CREATE TABLE audit(<br>EMP_no INT NOT NULL,<br>NAME TEXT NOT NULL<br>);</p>
<p>create trigger audit_log after insert on employees_test<br>begin<br>insert into audit values (new.ID, new.NAME);<br>end;</p>
<h1 id="41-构造一个触发器audit-log，在向employees表中插入"><a href="#41-构造一个触发器audit-log，在向employees表中插入" class="headerlink" title="41.构造一个触发器audit_log，在向employees表中插入"></a>41.构造一个触发器audit_log，在向employees表中插入</h1><h1 id="一条数据的时候，触发插入相关的数据到audit中"><a href="#一条数据的时候，触发插入相关的数据到audit中" class="headerlink" title="一条数据的时候，触发插入相关的数据到audit中"></a>一条数据的时候，触发插入相关的数据到audit中</h1><p>2020 年 5 月 18 日 18:18</p>
<h3 id="题目描述-38"><a href="#题目描述-38" class="headerlink" title="题目描述"></a>题目描述</h3><p>删除emp_no重复的记录，只保留最小的id对应的记录。</p>
<p>CREATE TABLE IF NOT EXISTS titles_test (<br>id int(11) not null primary key,<br>emp_no int(11) NOT NULL,<br>title varchar(50) NOT NULL,<br>from_date date NOT NULL,<br>to_date date DEFAULT NULL);</p>
<p>insert into titles_test values<br>(‘1’, ‘10001’, ‘Senior Engineer’, ‘1986- 06 - 26’, ‘9999- 01 - 01’),<br>(‘2’, ‘10002’, ‘Staff’, ‘1996- 08 - 03’, ‘9999- 01 - 01’),<br>(‘3’, ‘10003’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’),<br>(‘4’, ‘10004’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’),<br>(‘5’, ‘10001’, ‘Senior Engineer’, ‘1986- 06 - 26’, ‘9999- 01 - 01’),<br>(‘6’, ‘10002’, ‘Staff’, ‘1996- 08 - 03’, ‘9999- 01 - 01’),<br>(‘7’, ‘10003’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’);</p>
<p>1.group by和min 找到每个emp_no中 最小的id</p>
<p>2.删除不是这个最小id 数据</p>
<p>delete from titles_test<br>where id not in(<br>select min(id)<br>from titles_test<br>group by emp_no<br>);</p>
<h1 id="42-删除emp-no重复的记录，只保留最小的id对应的记"><a href="#42-删除emp-no重复的记录，只保留最小的id对应的记" class="headerlink" title="42.删除emp_no重复的记录，只保留最小的id对应的记"></a>42.删除emp_no重复的记录，只保留最小的id对应的记</h1><h1 id="录。"><a href="#录。" class="headerlink" title="录。"></a>录。</h1><p>2020 年 5 月 18 日 18:18</p>
<h3 id="题目描述-39"><a href="#题目描述-39" class="headerlink" title="题目描述"></a>题目描述</h3><p>将所有to_date为 9999 - 01 - 01 的全部更新为NULL,且from_date更新为 2001 - 01 - 01 。</p>
<p>CREATE TABLE IF NOT EXISTS titles_test (<br>id int(11) not null primary key,<br>emp_no int(11) NOT NULL,<br>title varchar(50) NOT NULL,<br>from_date date NOT NULL,<br>to_date date DEFAULT NULL);</p>
<p>insert into titles_test values (‘1’, ‘10001’, ‘Senior Engineer’, ‘1986- 06 - 26’, ‘9999- 01 - 01’),<br>(‘2’, ‘10002’, ‘Staff’, ‘1996- 08 - 03’, ‘9999- 01 - 01’),<br>(‘3’, ‘10003’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’),<br>(‘4’, ‘10004’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’),<br>(‘5’, ‘10001’, ‘Senior Engineer’, ‘1986- 06 - 26’, ‘9999- 01 - 01’),<br>(‘6’, ‘10002’, ‘Staff’, ‘1996- 08 - 03’, ‘9999- 01 - 01’),<br>(‘7’, ‘10003’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’);</p>
<p>update titles_test set to_date = null, from_date = ‘2001- 01 - 01’<br>where to_date = ‘9999- 01 - 01’;</p>
<h1 id="43-将所有to-date为-9999-01-01-的全部更新为NULL-且"><a href="#43-将所有to-date为-9999-01-01-的全部更新为NULL-且" class="headerlink" title="43.将所有to_date为 9999 - 01 - 01 的全部更新为NULL,且"></a>43.将所有to_date为 9999 - 01 - 01 的全部更新为NULL,且</h1><p>2020 年 5 月 18 日 18:18</p>
<h3 id="题目描述-40"><a href="#题目描述-40" class="headerlink" title="题目描述"></a>题目描述</h3><p>将id=5以及emp_no=10001的行数据替换成id=5以及emp_no=10005,其他数据保持不变，使用</p>
<p>replace实现。</p>
<p>CREATE TABLE IF NOT EXISTS titles_test (<br>id int(11) not null primary key,<br>emp_no int(11) NOT NULL,<br>title varchar(50) NOT NULL,<br>from_date date NOT NULL,<br>to_date date DEFAULT NULL);</p>
<p>insert into titles_test values (‘1’, ‘10001’, ‘Senior Engineer’, ‘1986- 06 - 26’, ‘9999- 01 - 01’),<br>(‘2’, ‘10002’, ‘Staff’, ‘1996- 08 - 03’, ‘9999- 01 - 01’),<br>(‘3’, ‘10003’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’),<br>(‘4’, ‘10004’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’),<br>(‘5’, ‘10001’, ‘Senior Engineer’, ‘1986- 06 - 26’, ‘9999- 01 - 01’),<br>(‘6’, ‘10002’, ‘Staff’, ‘1996- 08 - 03’, ‘9999- 01 - 01’),<br>(‘7’, ‘10003’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’);</p>
<p>replace into titles_test select 5,10005,title,from_date,to_date<br>from titles_test<br>where id = 5<br>and emp_no = 10001;</p>
<h1 id="44-将id-5以及emp-no-10001的行数据替换成id-5以及"><a href="#44-将id-5以及emp-no-10001的行数据替换成id-5以及" class="headerlink" title="44.将id=5以及emp_no=10001的行数据替换成id=5以及"></a>44.将id=5以及emp_no=10001的行数据替换成id=5以及</h1><h1 id="emp-no-10005-其他数据保持不变，使用replace实"><a href="#emp-no-10005-其他数据保持不变，使用replace实" class="headerlink" title="emp_no=10005,其他数据保持不变，使用replace实"></a>emp_no=10005,其他数据保持不变，使用replace实</h1><h1 id="现。"><a href="#现。" class="headerlink" title="现。"></a>现。</h1><p>2020 年 5 月 18 日 18:18</p>
<h3 id="题目描述-41"><a href="#题目描述-41" class="headerlink" title="题目描述"></a>题目描述</h3><p>将titles_test表名修改为titles_2017。</p>
<p>CREATE TABLE IF NOT EXISTS titles_test (<br>id int(11) not null primary key,<br>emp_no int(11) NOT NULL,<br>title varchar(50) NOT NULL,<br>from_date date NOT NULL,<br>to_date date DEFAULT NULL);</p>
<p>insert into titles_test values (‘1’, ‘10001’, ‘Senior Engineer’, ‘1986- 06 - 26’, ‘9999- 01 - 01’),<br>(‘2’, ‘10002’, ‘Staff’, ‘1996- 08 - 03’, ‘9999- 01 - 01’),<br>(‘3’, ‘10003’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’),<br>(‘4’, ‘10004’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’),<br>(‘5’, ‘10001’, ‘Senior Engineer’, ‘1986- 06 - 26’, ‘9999- 01 - 01’),<br>(‘6’, ‘10002’, ‘Staff’, ‘1996- 08 - 03’, ‘9999- 01 - 01’),<br>(‘7’, ‘10003’, ‘Senior Engineer’, ‘1995- 12 - 03’, ‘9999- 01 - 01’);</p>
<p>alter table titles_test rename to titles_2017;</p>
<h1 id="45-将titles-test表名修改为titles-2017"><a href="#45-将titles-test表名修改为titles-2017" class="headerlink" title="45.将titles_test表名修改为titles_2017"></a>45.将titles_test表名修改为titles_2017</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-42"><a href="#题目描述-42" class="headerlink" title="题目描述"></a>题目描述</h3><p>在audit表上创建外键约束，其emp_no对应employees_test表的主键id。</p>
<p>CREATE TABLE employees_test(<br>ID INT PRIMARY KEY NOT NULL,<br>NAME TEXT NOT NULL,<br>AGE INT NOT NULL,<br>ADDRESS CHAR(50),<br>SALARY REAL<br>);</p>
<p>CREATE TABLE audit(<br>EMP_no INT NOT NULL,<br>create_date datetime NOT NULL<br>);</p>
<p>drop table audit;<br>create table audit(<br>EMP_no int not null,<br>create_date datetime NOT NULL,<br>foreign key(EMP_no) references employees_test(ID));</p>
<h1 id="46-在audit表上创建外键约束，其emp-no对应"><a href="#46-在audit表上创建外键约束，其emp-no对应" class="headerlink" title="46.在audit表上创建外键约束，其emp_no对应"></a>46.在audit表上创建外键约束，其emp_no对应</h1><h1 id="employees-test表的主键id"><a href="#employees-test表的主键id" class="headerlink" title="employees_test表的主键id"></a>employees_test表的主键id</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-43"><a href="#题目描述-43" class="headerlink" title="题目描述"></a>题目描述</h3><h3 id="存在如下的视图："><a href="#存在如下的视图：" class="headerlink" title="存在如下的视图："></a>存在如下的视图：</h3><p>create view emp_v as select * from employees where emp_no &gt;10005;</p>
<p>如何获取emp_v和employees有相同的数据？</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>select * from emp_v;</p>
<p>select e.*<br>from employees e, emp_v ev<br>where e.emp_no = ev.emp_no;</p>
<p>select e.*<br>from employees e<br>intersect select ev.* from emp_v ev;</p>
<h1 id="47-如何获取emp-v和employees有相同的数据no"><a href="#47-如何获取emp-v和employees有相同的数据no" class="headerlink" title="47.如何获取emp_v和employees有相同的数据no"></a>47.如何获取emp_v和employees有相同的数据no</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-44"><a href="#题目描述-44" class="headerlink" title="题目描述"></a>题目描述</h3><h3 id="将所有获取奖金的员工当前的薪水增加10-。"><a href="#将所有获取奖金的员工当前的薪水增加10-。" class="headerlink" title="将所有获取奖金的员工当前的薪水增加10%。"></a>将所有获取奖金的员工当前的薪水增加10%。</h3><p>create table emp_bonus(<br>emp_no int not null,<br>recevied datetime not null,<br>btype smallint not null);<br>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL, PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>update salaries set salary = salary * 1.1<br>where emp_no in(<br>select s.emp_no<br>from salaries s<br>inner join emp_bonus eb<br>on s.emp_no = eb.emp_no<br>and s.to_date = ‘9999- 01 - 01’<br>);</p>
<h1 id="48-将所有获取奖金的员工当前的薪水增加10"><a href="#48-将所有获取奖金的员工当前的薪水增加10" class="headerlink" title="48.将所有获取奖金的员工当前的薪水增加10%"></a>48.将所有获取奖金的员工当前的薪水增加10%</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-45"><a href="#题目描述-45" class="headerlink" title="题目描述"></a>题目描述</h3><p>针对库中的所有表生成select count(*)对应的SQL语句</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));<br>create table emp_bonus(<br>emp_no int not null,<br>recevied datetime not null,<br>btype smallint not null);<br>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>dept_manager</code> (<br><code>dept_no</code> char(4) NOT NULL,<br><code>emp_no</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>输出格式:</p>
<p>cnts<br>select count(<em>) from employees;<br>select count(</em>) from departments;<br>select count(<em>) from dept_emp;<br>select count(</em>) from dept_manager;<br>select count(<em>) from salaries;<br>select count(</em>) from titles;<br>select count(*) from emp_bonus;</p>
<p>select ‘select count(*) from ‘||name||’;’ cnts<br>from sqlite_master where type = ‘table’;</p>
<h1 id="49-针对库中的所有表生成select"><a href="#49-针对库中的所有表生成select" class="headerlink" title="49.针对库中的所有表生成select"></a>49.针对库中的所有表生成select</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-46"><a href="#题目描述-46" class="headerlink" title="题目描述"></a>题目描述</h3><p>将employees表中的所有员工的last_name和first_name通过(‘)连接起来。</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>输出格式:</p>
<p>name<br>Facello’Georgi<br>Simmel’Bezalel<br>Bamford’Parto<br>Koblick’Chirstian<br>Maliniak’Kyoichi<br>Preusig’Anneke<br>Zielinski’Tzvetan<br>Kalloufi’Saniya<br>Peac’Sumant<br>Piveteau’Duangkaew<br>Sluis’Mary</p>
<p>select last_name||”‘“||first_name name<br>from employees;</p>
<h1 id="50-将employees表中的所有员工的last-name和"><a href="#50-将employees表中的所有员工的last-name和" class="headerlink" title="50.将employees表中的所有员工的last_name和"></a>50.将employees表中的所有员工的last_name和</h1><h1 id="first-name通过-‘-连接起来。"><a href="#first-name通过-‘-连接起来。" class="headerlink" title="first_name通过(‘)连接起来。"></a>first_name通过(‘)连接起来。</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-47"><a href="#题目描述-47" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找字符串’10,A,B’ 中逗号’,’出现的次数cnt。</p>
<p>select (length(“10,A,B”) -length(replace(“10,A,B”,”,”,””)))/length(“,”) as cnt;</p>
<h1 id="51-查找字符串’10-A-B’"><a href="#51-查找字符串’10-A-B’" class="headerlink" title="51.查找字符串’10,A,B’"></a>51.查找字符串’10,A,B’</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-48"><a href="#题目描述-48" class="headerlink" title="题目描述"></a>题目描述</h3><p>获取Employees中的first_name，查询按照first_name最后两个字母，按照升序进行排列</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>输出格式：</p>
<p>first_name<br>Chirstian<br>Tzvetan<br>Bezalel<br>Duangkaew<br>Georgi<br>Kyoichi<br>Anneke<br>Sumant<br>Mary<br>Parto<br>Saniya</p>
<p>select first_name<br>from employees<br>order by substr(first_name,-2,2) asc;</p>
<h1 id="52-获取Employees中的first-name，查询按照first-name"><a href="#52-获取Employees中的first-name，查询按照first-name" class="headerlink" title="52.获取Employees中的first_name，查询按照first_name"></a>52.获取Employees中的first_name，查询按照first_name</h1><h1 id="最后两个字母，按照升序进行排列"><a href="#最后两个字母，按照升序进行排列" class="headerlink" title="最后两个字母，按照升序进行排列"></a>最后两个字母，按照升序进行排列</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-49"><a href="#题目描述-49" class="headerlink" title="题目描述"></a>题目描述</h3><p>按照dept_no进行汇总，属于同一个部门的emp_no按照逗号进行连接，结果给出dept_no以及</p>
<p>连接出的结果employees</p>
<p>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));</p>
<p>输出格式:</p>
<p>dept_no employees<br>d001 10001,10002<br>d002 10006<br>d003 10005<br>d004 10003,10004<br>d005 10007,10008,10010<br>d006 10009,10010</p>
<p>select dept_no, group_concat(emp_no,”,”) employees<br>from dept_emp<br>group by dept_no;</p>
<h1 id="53-按照dept-no进行汇总，属于同一个部门的emp-no"><a href="#53-按照dept-no进行汇总，属于同一个部门的emp-no" class="headerlink" title="53.按照dept_no进行汇总，属于同一个部门的emp_no"></a>53.按照dept_no进行汇总，属于同一个部门的emp_no</h1><h1 id="按照逗号进行连接，结果给出dept-no以及连接出的"><a href="#按照逗号进行连接，结果给出dept-no以及连接出的" class="headerlink" title="按照逗号进行连接，结果给出dept_no以及连接出的"></a>按照逗号进行连接，结果给出dept_no以及连接出的</h1><h1 id="结果employees"><a href="#结果employees" class="headerlink" title="结果employees"></a>结果employees</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-50"><a href="#题目描述-50" class="headerlink" title="题目描述"></a>题目描述</h3><p>查找排除当前最大、最小salary之后的员工的平均工资avg_salary。</p>
<p>CREATE TABLE <code>salaries</code> ( <code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>输出格式:</p>
<p>avg_salary<br>69462.5555555556</p>
<p>select avg(salary) avg_salary<br>from salaries<br>where to_date = ‘9999- 01 - 01’<br>and salary not in(<br>select max(salary)<br>from salaries<br>)<br>and salary not in(<br>select min(salary)<br>from salaries<br>);</p>
<h1 id="54-查找排除当前最大、最小salary之后的员工的平均"><a href="#54-查找排除当前最大、最小salary之后的员工的平均" class="headerlink" title="54.查找排除当前最大、最小salary之后的员工的平均"></a>54.查找排除当前最大、最小salary之后的员工的平均</h1><h1 id="工资avg-salary"><a href="#工资avg-salary" class="headerlink" title="工资avg_salary"></a>工资avg_salary</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-51"><a href="#题目描述-51" class="headerlink" title="题目描述"></a>题目描述</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">分页查询employees表，每 5 行一页，返回第 2 页的数据</span><br><span class="line">CREATE TABLE &#96;employees&#96; (</span><br><span class="line">&#96;emp_no&#96; int(11) NOT NULL,</span><br><span class="line">&#96;birth_date&#96; date NOT NULL,</span><br><span class="line">&#96;first_name&#96; varchar(14) NOT NULL,</span><br><span class="line">&#96;last_name&#96; varchar(16) NOT NULL,</span><br><span class="line">&#96;gender&#96; char(1) NOT NULL,</span><br><span class="line">&#96;hire_date&#96; date NOT NULL,</span><br><span class="line">PRIMARY KEY (&#96;emp_no&#96;));</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">公式：limit (页数-1)*每一页的数量，每一页的数量</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from employees</span><br><span class="line">limit (2-1)*5,5;</span><br></pre></td></tr></table></figure>
<h1 id="55-分页查询employees表，每-5-行一页，返回第-2-页的"><a href="#55-分页查询employees表，每-5-行一页，返回第-2-页的" class="headerlink" title="55.分页查询employees表，每 5 行一页，返回第 2 页的"></a>55.分页查询employees表，每 5 行一页，返回第 2 页的</h1><h1 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-52"><a href="#题目描述-52" class="headerlink" title="题目描述"></a>题目描述</h3><p>获取所有员工的emp_no、部门编号dept_no以及对应的bonus类型btype和received ，没有分配</p>
<p>具体的员工不显示</p>
<p>CREATE TABLE <code>dept_emp</code> ( <code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>dept_manager</code> (<br><code>dept_no</code> char(4) NOT NULL,<br><code>emp_no</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));<br>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));<br>create table emp_bonus(<br>emp_no int not null,<br>received datetime not null,<br>btype smallint not null);</p>
<p>输出格式:</p>
<p>e.emp_no dept_no btype received<br>10001 d001 1 2010 - 01 - 01<br>10002 d001 2 2010 - 10 - 01<br>10003 d004 3 2011 - 12 - 03<br>10004 d004 1 2010 - 01 - 01<br>10005 d003<br>10006 d002<br>10007 d005<br>10008 d005<br>10009 d006<br>10010 d005<br>10010 d006</p>
<p>select e.emp_no,de.dept_no,eb.btype,eb.recevied<br>from employees e<br>inner join dept_emp de<br>on e.emp_no = de.emp_no</p>
<h1 id="56-获取所有员工的emp-no"><a href="#56-获取所有员工的emp-no" class="headerlink" title="56.获取所有员工的emp_no"></a>56.获取所有员工的emp_no</h1><p>2020 年 5 月 18 日 18:19</p>
<p>on e.emp_no = de.emp_no<br>left join emp_bonus eb<br>on e.emp_no = eb.emp_no;</p>
<h3 id="题目描述-53"><a href="#题目描述-53" class="headerlink" title="题目描述"></a>题目描述</h3><p>使用含有关键字exists查找未分配具体部门的员工的所有信息。</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));<br>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));</p>
<p>输出格式:</p>
<p>emp_no birth_date first_name last_name genderhire_date<br>10011 1953 - 11 - 07 Mary Sluis F 1990 - 01 - 22</p>
<p>select *<br>from employees e<br>where not exists(<br>select *<br>from dept_emp de<br>where de.emp_no = e.emp_no<br>);</p>
<h1 id="57-使用含有关键字exists查找未分配具体部门的员工"><a href="#57-使用含有关键字exists查找未分配具体部门的员工" class="headerlink" title="57.使用含有关键字exists查找未分配具体部门的员工"></a>57.使用含有关键字exists查找未分配具体部门的员工</h1><h1 id="的所有信息。"><a href="#的所有信息。" class="headerlink" title="的所有信息。"></a>的所有信息。</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-54"><a href="#题目描述-54" class="headerlink" title="题目描述"></a>题目描述</h3><h3 id="存在如下的视图：-1"><a href="#存在如下的视图：-1" class="headerlink" title="存在如下的视图："></a>存在如下的视图：</h3><p>create view emp_v as select * from employees where emp_no &gt;10005;<br>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>获取employees中的行数据，且这些行也存在于emp_v中。注意不能使用intersect关键字。</p>
<p>输出格式:</p>
<p>emp_no birth_date first_name last_name genderhire_date<br>10006 1953 - 04 - 20 AnnekePreusigF 1989 - 06 - 02<br>10007 1957 - 05 - 23 TzvetanZielinskiF 1989 - 02 - 10<br>10008 1958 - 02 - 19 Saniya KalloufiM 1994 - 09 - 15<br>10009 1952 - 04 - 19 SumantPeac F 1985 - 02 - 18<br>10010 1963 - 06 - 01 Duangkaew Piveteau F 1989 - 08 - 24<br>10011 1953 - 11 - 07 Mary Sluis F 1990 - 01 - 22</p>
<p>select * from emp_v;</p>
<p>select e.*<br>from employees e, emp_v ev<br>where e.emp_no = ev.emp_no;</p>
<h1 id="58-获取employees中的行数据，且这些行也存在于"><a href="#58-获取employees中的行数据，且这些行也存在于" class="headerlink" title="58.获取employees中的行数据，且这些行也存在于"></a>58.获取employees中的行数据，且这些行也存在于</h1><h1 id="emp-v中"><a href="#emp-v中" class="headerlink" title="emp_v中"></a>emp_v中</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-55"><a href="#题目描述-55" class="headerlink" title="题目描述"></a>题目描述</h3><h3 id="获取有奖金的员工相关信息。"><a href="#获取有奖金的员工相关信息。" class="headerlink" title="获取有奖金的员工相关信息。"></a>获取有奖金的员工相关信息。</h3><p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));<br>CREATE TABLE <code>dept_emp</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>dept_no</code> char(4) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>dept_no</code>));<br>create table emp_bonus(<br>emp_no int not null,<br>recevied datetime not null,<br>btype smallint not null);<br>CREATE TABLE <code>salaries</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL, PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>给出emp_no、first_name、last_name、奖金类型btype、对应的当前薪水情况salary以及奖金金</p>
<p>额bonus。bonus类型btype为 1 其奖金为薪水salary的10%，btype为 2 其奖金为薪水的20%，其他</p>
<p>类型均为薪水的30%。 当前薪水表示to_date=’9999- 01 - 01’</p>
<p>输出格式:</p>
<p>emp_no first_name last_name btype salary bonus<br>10001 Georgi Facello 1 88958 8895.8<br>10002 BezalelSimmel 2 72527 14505.4<br>10003 Parto Bamford 3 43311 12993.3<br>10004 Chirstian Koblick 1 74057 7405.7</p>
<p>select e.emp_no, e.first_name, e.last_name, b.btype, s.salary,(<br>case b.btype<br>when 1 then s.salary<em>0.1<br>when 2 then s.salary</em>0.2<br>else s.salary*0.3<br>end<br>) bonus<br>from employees e<br>inner join emp_bonus b<br>on e.emp_no = b.emp_no<br>inner join salaries s<br>on s.emp_no = e.emp_no<br>and s.to_date=’9999- 01 - 01’;</p>
<h1 id="59-获取有奖金的员工相关信息。"><a href="#59-获取有奖金的员工相关信息。" class="headerlink" title="59.获取有奖金的员工相关信息。"></a>59.获取有奖金的员工相关信息。</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-56"><a href="#题目描述-56" class="headerlink" title="题目描述"></a>题目描述</h3><p>按照salary的累计和running_total，其中running_total为前两个员工的salary累计和，其他以此类</p>
<p>推。 具体结果如下Demo展示。。</p>
<p>CREATE TABLE <code>salaries</code> ( <code>emp_no</code> int(11) NOT NULL,<br><code>salary</code> int(11) NOT NULL,<br><code>from_date</code> date NOT NULL,<br><code>to_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>,<code>from_date</code>));</p>
<p>输出格式:</p>
<p>emp_no salary running_total<br>10001 88958 88958<br>10002 72527 161485<br>10003 43311 204796<br>10004 74057 278853<br>10005 94692 373545<br>10006 43311 416856<br>10007 88070 504926<br>10009 95409 600335<br>10010 94409 694744<br>10011 25828 720572</p>
<p>select s.emp_no, s.salary,(<br>select sum(s2.salary)<br>from salaries s2<br>where s2.emp_no &lt;= s.emp_no<br>and s2.to_date = ‘9999- 01 - 01’<br>) running_total<br>from salaries s<br>where s.to_date = ‘9999- 01 - 01’<br>order by s.emp_no asc;</p>
<h1 id="60-统计salary的累计和running-total"><a href="#60-统计salary的累计和running-total" class="headerlink" title="60.统计salary的累计和running_total"></a>60.统计salary的累计和running_total</h1><p>2020 年 5 月 18 日 18:19</p>
<h3 id="题目描述-57"><a href="#题目描述-57" class="headerlink" title="题目描述"></a>题目描述</h3><p>对于employees表中，给出奇数行的first_name</p>
<p>CREATE TABLE <code>employees</code> (<br><code>emp_no</code> int(11) NOT NULL,<br><code>birth_date</code> date NOT NULL,<br><code>first_name</code> varchar(14) NOT NULL,<br><code>last_name</code> varchar(16) NOT NULL,<br><code>gender</code> char(1) NOT NULL,<br><code>hire_date</code> date NOT NULL,<br>PRIMARY KEY (<code>emp_no</code>));</p>
<p>输出格式:</p>
<p>first_name<br>Georgi<br>Chirstian<br>Anneke<br>Tzvetan<br>Saniya<br>Mary</p>
<h3 id="题目描述错误："><a href="#题目描述错误：" class="headerlink" title="题目描述错误："></a>题目描述错误：</h3><p>更改为：对first_name 先排序 后给出奇数行</p>
<p>select e1.first_name<br>from employees e1<br>where(<br>select count(*)<br>from employees e2<br>where e1.first_name &lt;= e2.first_name<br>) % 2 = 1;</p>
<h1 id="61-对于employees表中，给出奇数行的first-name"><a href="#61-对于employees表中，给出奇数行的first-name" class="headerlink" title="61.对于employees表中，给出奇数行的first_name"></a>61.对于employees表中，给出奇数行的first_name</h1><p>2020 年 5 月 18 日 18:19</p>
<p>This is a offline tool, your data stays locally and is not send to any server!<br>Feedback &amp; Bug Reports</p>

      
    </div>
    
  </div>
  
	  
	  <div id="git"></div>
<link rel="stylesheet" href="https://billts.site/extra_css/gitment.css">
<script src="https://billts.site/js/gitment.js"></script>
<script>
var gitment = new Gitment({
  id: window.decodeURIComponent(window.location.pathname),
  owner: 'nlby',
  repo: 'nlbyvh.github.io',
  oauth: {
    client_id: '6d53a92df707fc123e7a',
    client_secret: '2bd9e28afe88cb142fa8fa7092c9a8c20ae25555',
  },
})
gitment.render('git')
</script>
	  
    
<nav id="article-nav">
  
    <a href="/2020/08/03/zimug_study_1/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          zimug_study_1
        
      </div>
    </a>
  
  
    <a href="/2020/07/31/fabric_1/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">fabric_1</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>


<div class="ds-share share" data-thread-key="sql_study_1" data-title="sql_study_1" data-url="http://yoursite.com/2020/08/03/sql_study_1/"  data-images="https://i.loli.net/2020/03/21/oSCA8lZVKMG6OBp.jpg" data-content="sql_study_1">
    <div class="ds-share-inline">
      <ul  class="ds-share-icons-16">
	    <!--
      	<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>-->
      </ul>
      <div class="ds-share-icons-more">
      </div>
    </div>
 </div>
 







</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2020 nlby
      </div>
	  <!--<audio src="/music/1.mp3" autoplay="autoplay" loop="-1" /></audio>-->
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>

    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/hk416.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>